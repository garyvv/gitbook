# Linux大文件已删除，但df查看已使用的空间并未减少解决

在我的生活当中遇到磁盘快满了，这时候准备去删除一些大文件

于是我使用ncdu 查看了一下当前系统占用资源比较多的是那些文件，结果一看是elasticsearch的日志文件，好吧，竟然找到源头了，那就把它给删除了吧，

来到相应的路径下之后，然后粗暴一点，执行  rm   -rf   *

很高兴，终于把这些占用系统资源的坏东西给杀死了。满心欢喜的去查看磁盘情况。

给我当头一棒，磁盘并没有多大的变化，之后释放了100多M，但是我明明删除了30G的文件啊，这是怎么回事。

有问题不可怕，干净找baidu/google，找到原因了，说是虽然删除了，但是没有释放资源。

从网上找了一些资料：

执行  
```
lsof | grep deleted
```
我发现有大量刚刚删除文件的进程存在，果断给他kill 掉。但是可能会造成一些影响，比如说一下正在写的文件，之前那样删除的方法就是不对的。



4、解决问题

到 这里问题就基本排查清楚了，解决这一类问题的方法有很多种，最简单的方法是关闭或者重启httpd进程，当然也可以重启操作系统，不过这并不是最好的方 法，对待这种进程不停对文件写日志的操作，要释放文件占用的磁盘空间，最好的方法是在线清空这个文件，可以通过如下命令完成：

[root@localhost ~]# echo " " >/tmp/acess.log

通过这种方法，磁盘空间不但可以马上释放，也可保障进程继续向文件写入日志，这种方法经常用于在线清理Apache、Tomcat、Nginx等Web服务产生的日志文件。